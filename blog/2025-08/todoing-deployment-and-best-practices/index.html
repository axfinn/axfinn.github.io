<!DOCTYPE html>
<html lang="zn-Hans">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, maximum-scale=1" />
  <meta name="author" content="jaxiu He">
  <meta name="description" content="todoIng 部署方案与最佳实践
在前面的系列文章中，我们详细介绍了 todoIng 的各项功能和实现原理。今天，我们将探讨如何部署 todoIng 应用，并分享一些在实际部署过程中的最佳实践。
部署方案概览
todoIng 支持多种部署方式，以适应不同的使用场景和需求：

Docker Compose 部署（推荐）：适用于生产环境和测试环境
手动部署：适用于开发环境和自定义配置
云平台部署：适用于需要高可用性和扩展性的场景

Docker Compose 部署（推荐）
Docker Compose 是部署 todoIng 的推荐方式，它能够快速启动整个应用栈，包括前端、后端和数据库。">
  
  <meta property="og:url" content="https://axfinn.github.io/blog/2025-08/todoing-deployment-and-best-practices/">
  <meta property="og:site_name" content="jaxiu He">
  <meta property="og:title" content="todoIng 部署方案与最佳实践">
  <meta property="og:description" content="todoIng 部署方案与最佳实践 在前面的系列文章中，我们详细介绍了 todoIng 的各项功能和实现原理。今天，我们将探讨如何部署 todoIng 应用，并分享一些在实际部署过程中的最佳实践。
部署方案概览 todoIng 支持多种部署方式，以适应不同的使用场景和需求：
Docker Compose 部署（推荐）：适用于生产环境和测试环境 手动部署：适用于开发环境和自定义配置 云平台部署：适用于需要高可用性和扩展性的场景 Docker Compose 部署（推荐） Docker Compose 是部署 todoIng 的推荐方式，它能够快速启动整个应用栈，包括前端、后端和数据库。">
  <meta property="og:locale" content="zn_Hans">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2025-08-03T16:00:00+08:00">
    <meta property="article:modified_time" content="2025-08-03T16:00:00+08:00">
    <meta property="article:tag" content="TodoIng">
    <meta property="article:tag" content="部署">
    <meta property="article:tag" content="Docker">
    <meta property="article:tag" content="最佳实践">
    <meta property="article:tag" content="DevOps">


  <title>
  
       todoIng 部署方案与最佳实践 | jaxiu He 
  
  </title>

  <link rel="canonical" href="https://axfinn.github.io/blog/2025-08/todoing-deployment-and-best-practices/">

  
  

  
  <link href="https://axfinn.github.io/css/vendors-extensions/fontawesome/all.min.css" rel="stylesheet">

  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:300,400,500,600">
  <link href="https://axfinn.github.io/css/font.css" rel="stylesheet"> 
    
  
  <link href="https://axfinn.github.io/css/vendors/bootstrap4/bootstrap.min.css" rel="stylesheet">
  <link href="https://axfinn.github.io/css/vendors-extensions/mdb/mdb.min.css" rel="stylesheet"> 
  <link href="https://axfinn.github.io/css/vendors/mdb/style.min.css" rel="stylesheet"> 
  <link href="https://axfinn.github.io/css/main.css" rel="stylesheet">


  
  <link rel="shortcut icon"
  
      href="https://axfinn.github.io/img/logo.png"
  
  >


  
  

  <style type="text/css">
      @media (min-width: 800px) and (max-width: 850px) {
              .navbar:not(.top-nav-collapse) {
                  background: #1C2331!important;
              }
          }
  </style>


  
    
    <link rel="stylesheet" href="https://axfinn.github.io/js/vendors/katex/katex.min.css">
  
  

  
    
    <link rel="stylesheet" href="https://axfinn.github.io/css/vendors/highlight/github-gist.css">
  

  
  
  <script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({ startOnLoad: true });
  </script>
  
  

  
  <script src="https://axfinn.github.io/js/dynamic-bg.js"></script>
  <link href="https://axfinn.github.io/css/dynamic-bg-control.css" rel="stylesheet">

</head>

  <body class="bg-light" data-spy="scroll" data-target="#page-scrollspy" data-offset="90">
  
    
    

    
      


<nav class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar">
    <div class="container">

      
      <a class="navbar-brand" href="https://axfinn.github.io/">
          
        <img class="avatar" src="https://axfinn.github.io/img/logo.png" style="width: 40px!important;height: auto;"  class="d-inline-block align-top" alt="" >
        
        <strong> jaxiu He</strong>
      </a>

      
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      
      <div class="collapse navbar-collapse" id="navbarSupportedContent">

        
        <ul class="navbar-nav mr-auto ">
          <li class="nav-item ">
            <a class="nav-link" href="https://axfinn.github.io/">Home</a>
          </li>
             
            <li class="nav-item ">
              <a class="nav-link" href="https://axfinn.github.io/blog/" >博客  </a>
            </li>
          
             
            <li class="nav-item ">
              <a class="nav-link" href="https://axfinn.github.io/moment/" >动态  </a>
            </li>
          
             
            <li class="nav-item ">
              <a class="nav-link" href="https://axfinn.github.io/about/" >关于  </a>
            </li>
          
          
        </ul>

        
        <ul class="navbar-nav nav-flex-icons">
          <li class="nav-item">
            <form class="form-inline my-2 my-lg-0">
              <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search" id="search-query">
              <div class="dropdown-wrapper">
                <ul id="search-results" class="dropdown-menu"></ul>
              </div>
            </form>
          </li>
        </ul>

      </div>

    </div>
  </nav>
  
  <script src="https://axfinn.github.io/js/search.js"></script>
 
      
 






<div id="site-header" class="carousel slide carousel-fade" data-ride="carousel" style="height: 18rem;" >  

  
  
  

  
  <div class="carousel-inner" role="listbox">
    
      

        
        <div class="carousel-item active">
          <div class="view" style="background-image: url('https://axfinn.github.io/img/header-slides/raw_1515691746.jpg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

              
              
              

            </div>
            

          </div>
        </div>
        
      
    
      

        
        <div class="carousel-item">
          <div class="view" style="background-image: url('https://axfinn.github.io/img/header-slides//raw_1515847341.jpg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

            

            </div>
            

          </div>
        </div>
        
      
    

  
  </div>
  

  
  <div class="carousel-content text-center white-text wow fadeIn">
    <div class="row mx-0 headfont mt-3 pt-4">
      
      <div class="col-12 col-sm-5 align-middle">
        <a href="https://axfinn.github.io/">
          
            <img class="pull-right avatar avatar-md" src="https://axfinn.github.io/img/logo.png" alt="" >
          
        </a>
      </div>
      
      <div class="col-12 col-sm-7 text-left pl-2">
        <a href="https://axfinn.github.io/">
          <h1 class="mb-2 h1" style="font-weight: 300;" >
            <strong>jaxiu He</strong>
          </h1>
        </a>
        

             
        <div class="mt-2" style="font-size: 1rem; color: white;">
            
              <a href="//github.com/axfinn" target="_blank" rel="noopener"><i class="fab fa-github pr-1" aria-hidden="true"></i></a>    
            
            

            

            

            

            
    
            
    
        
            
                <a href="mailto:521very@email.com"><i class="far fa-envelope-open pr-1" aria-hidden="true"></i></a>
            
    
            

            
        </div>
      </div>
    </div>
  </div>
  

  
  
  

</div>
  
    

    
  
  <main class="post-main-wrapper">
    
    
    <div class="row">

      

      
      <div class="container pr-5">
      

        
        <div class="z-depth-1  post-wrapper white-bg single-post">

          <div class="post-header text-center" >
  <ul class="post-meta li-x">
    
      
        <li><a href="https://axfinn.github.io/categories/%E6%8A%80%E6%9C%AF"><i class="fas fa-folder-open pr-1" aria-hidden="true"></i> 技术 </a></li>
      
        <li><a href="https://axfinn.github.io/categories/%E8%BF%90%E7%BB%B4"><i class="fas fa-folder-open pr-1" aria-hidden="true"></i> 运维 </a></li>
      
    
    
  </ul>

  <div class="px-4 post-heading">todoIng 部署方案与最佳实践</div>

  <ul class="post-meta li-x mt-1">
    
      <li>Aug 3, 2025</li>
    

    
      <li class="middot"></li>
      <li>4 minutes read</li>
    
  </ul>
  

</div>


          <div class="post-content markdown">
            <h1 id="todoing-部署方案与最佳实践">todoIng 部署方案与最佳实践</h1>
<p>在前面的系列文章中，我们详细介绍了 todoIng 的各项功能和实现原理。今天，我们将探讨如何部署 todoIng 应用，并分享一些在实际部署过程中的最佳实践。</p>
<h2 id="部署方案概览">部署方案概览</h2>
<p>todoIng 支持多种部署方式，以适应不同的使用场景和需求：</p>
<ol>
<li><strong>Docker Compose 部署</strong>（推荐）：适用于生产环境和测试环境</li>
<li><strong>手动部署</strong>：适用于开发环境和自定义配置</li>
<li><strong>云平台部署</strong>：适用于需要高可用性和扩展性的场景</li>
</ol>
<h2 id="docker-compose-部署推荐">Docker Compose 部署（推荐）</h2>
<p>Docker Compose 是部署 todoIng 的推荐方式，它能够快速启动整个应用栈，包括前端、后端和数据库。</p>
<h3 id="环境准备">环境准备</h3>
<p>首先确保系统已安装 Docker 和 Docker Compose：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 安装 Docker（Ubuntu 示例）</span>
</span></span><span class="line"><span class="cl">curl -fsSL https://get.docker.com -o get-docker.sh
</span></span><span class="line"><span class="cl">sudo sh get-docker.sh
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 安装 Docker Compose</span>
</span></span><span class="line"><span class="cl">sudo curl -L <span class="s2">&#34;https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-</span><span class="k">$(</span>uname -s<span class="k">)</span><span class="s2">-</span><span class="k">$(</span>uname -m<span class="k">)</span><span class="s2">&#34;</span> -o /usr/local/bin/docker-compose
</span></span><span class="line"><span class="cl">sudo chmod +x /usr/local/bin/docker-compose
</span></span></code></pre></div><h3 id="部署步骤">部署步骤</h3>
<ol>
<li>克隆项目代码：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">git clone https://github.com/axfinn/todoIng.git
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> todoIng
</span></span></code></pre></div><ol start="2">
<li>配置环境变量：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 后端环境变量</span>
</span></span><span class="line"><span class="cl">cp backend/.env.example backend/.env
</span></span><span class="line"><span class="cl"><span class="c1"># 编辑 backend/.env 文件，设置必要的环境变量</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 前端环境变量</span>
</span></span><span class="line"><span class="cl">cp frontend/.env.example frontend/.env
</span></span><span class="line"><span class="cl"><span class="c1"># 编辑 frontend/.env 文件，设置必要的环境变量</span>
</span></span></code></pre></div><ol start="3">
<li>启动服务：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 使用默认的 docker-compose.yml 文件</span>
</span></span><span class="line"><span class="cl">docker-compose up -d
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 或者使用特定环境的配置文件</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 开发环境</span>
</span></span><span class="line"><span class="cl">docker-compose -f docker-compose.dev.yml up -d
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 本地测试环境</span>
</span></span><span class="line"><span class="cl">docker-compose -f docker-compose.local.yml up -d
</span></span></code></pre></div><ol start="4">
<li>访问应用：</li>
</ol>
<pre tabindex="0"><code>前端: http://localhost
后端 API: http://localhost:5001/api
</code></pre><h3 id="docker-compose-配置文件详解">Docker Compose 配置文件详解</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="c"># docker-compose.yml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s1">&#39;3.8&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">services</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># MongoDB 数据库</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mongodb</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l">mongo:6.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">todoing_mongodb</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">MONGO_INITDB_ROOT_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="l">${MONGO_ROOT_USERNAME}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">MONGO_INITDB_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="l">${MONGO_ROOT_PASSWORD}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">mongodb_data:/data/db</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">./mongo-init.js:/docker-entrypoint-initdb.d/mongo-init.js:ro</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;27017:27017&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">todoing_network</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># 后端服务</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">backend</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l">./backend</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l">Dockerfile</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">todoing_backend</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">environment</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">NODE_ENV=production</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">MONGO_URI=mongodb://mongodb:27017/todoing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">JWT_SECRET=${JWT_SECRET}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">OPENAI_API_KEY=${OPENAI_API_KEY}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;5001:5001&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">mongodb</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">todoing_network</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c"># 前端服务</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">frontend</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">build</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">context</span><span class="p">:</span><span class="w"> </span><span class="l">./frontend</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">dockerfile</span><span class="p">:</span><span class="w"> </span><span class="l">Dockerfile</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l">todoing_frontend</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l">always</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">ports</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="s2">&#34;80:80&#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">backend</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span>- <span class="l">todoing_network</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">volumes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mongodb_data</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">networks</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">todoing_network</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l">bridge</span><span class="w">
</span></span></span></code></pre></div><h3 id="环境变量配置">环境变量配置</h3>
<h4 id="后端环境变量backendenv">后端环境变量（backend/.env）</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># MongoDB 配置</span>
</span></span><span class="line"><span class="cl"><span class="nv">MONGO_URI</span><span class="o">=</span>mongodb://localhost:27017/todoing
</span></span><span class="line"><span class="cl"><span class="nv">MONGO_ROOT_USERNAME</span><span class="o">=</span>admin
</span></span><span class="line"><span class="cl"><span class="nv">MONGO_ROOT_PASSWORD</span><span class="o">=</span>password
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># JWT 配置</span>
</span></span><span class="line"><span class="cl"><span class="nv">JWT_SECRET</span><span class="o">=</span>your_jwt_secret_key_here_change_this_in_production
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 安全配置</span>
</span></span><span class="line"><span class="cl"><span class="nv">DISABLE_REGISTRATION</span><span class="o">=</span><span class="nb">false</span>
</span></span><span class="line"><span class="cl"><span class="nv">ENABLE_CAPTCHA</span><span class="o">=</span><span class="nb">false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># OpenAI 配置（可选）</span>
</span></span><span class="line"><span class="cl"><span class="nv">OPENAI_API_KEY</span><span class="o">=</span>your_openai_api_key_here
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 默认用户配置（可选）</span>
</span></span><span class="line"><span class="cl"><span class="nv">DEFAULT_USERNAME</span><span class="o">=</span>admin
</span></span><span class="line"><span class="cl"><span class="nv">DEFAULT_EMAIL</span><span class="o">=</span>admin@example.com
</span></span></code></pre></div><h4 id="前端环境变量frontendenv">前端环境变量（frontend/.env）</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># API 地址</span>
</span></span><span class="line"><span class="cl"><span class="nv">VITE_API_URL</span><span class="o">=</span>http://localhost:5001/api
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 功能开关</span>
</span></span><span class="line"><span class="cl"><span class="nv">VITE_ENABLE_CAPTCHA</span><span class="o">=</span><span class="nb">false</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># OpenAI 配置（可选）</span>
</span></span><span class="line"><span class="cl"><span class="nv">VITE_OPENAI_API_KEY</span><span class="o">=</span>your_openai_api_key_here
</span></span></code></pre></div><h2 id="手动部署">手动部署</h2>
<p>对于需要更多自定义配置的场景，可以选择手动部署方式。</p>
<h3 id="后端部署">后端部署</h3>
<ol>
<li>安装依赖：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> backend
</span></span><span class="line"><span class="cl">npm install
</span></span></code></pre></div><ol start="2">
<li>配置环境变量：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp .env.example .env
</span></span><span class="line"><span class="cl"><span class="c1"># 编辑 .env 文件</span>
</span></span></code></pre></div><ol start="3">
<li>启动服务：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 生产环境</span>
</span></span><span class="line"><span class="cl">npm start
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 开发环境</span>
</span></span><span class="line"><span class="cl">npm run dev
</span></span></code></pre></div><h3 id="前端部署">前端部署</h3>
<ol>
<li>安装依赖：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nb">cd</span> frontend
</span></span><span class="line"><span class="cl">npm install
</span></span></code></pre></div><ol start="2">
<li>配置环境变量：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">cp .env.example .env
</span></span><span class="line"><span class="cl"><span class="c1"># 编辑 .env 文件</span>
</span></span></code></pre></div><ol start="3">
<li>构建和启动：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 构建生产版本</span>
</span></span><span class="line"><span class="cl">npm run build
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 预览生产构建</span>
</span></span><span class="line"><span class="cl">npm run preview
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 或者开发模式启动</span>
</span></span><span class="line"><span class="cl">npm run dev
</span></span></code></pre></div><h2 id="云平台部署">云平台部署</h2>
<p>todoIng 也可以部署到各种云平台，如 AWS、Azure、Google Cloud 等。</p>
<h3 id="部署到-heroku">部署到 Heroku</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 登录 Heroku</span>
</span></span><span class="line"><span class="cl">heroku login
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 创建应用</span>
</span></span><span class="line"><span class="cl">heroku create your-todoing-app
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 设置环境变量</span>
</span></span><span class="line"><span class="cl">heroku config:set <span class="nv">MONGO_URI</span><span class="o">=</span>your_mongodb_uri
</span></span><span class="line"><span class="cl">heroku config:set <span class="nv">JWT_SECRET</span><span class="o">=</span>your_jwt_secret
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 部署</span>
</span></span><span class="line"><span class="cl">git push heroku main
</span></span></code></pre></div><h3 id="部署到-aws">部署到 AWS</h3>
<p>可以使用 AWS ECS 或 Elastic Beanstalk 部署 todoIng：</p>
<ol>
<li>构建 Docker 镜像：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker build -t todoing-backend ./backend
</span></span><span class="line"><span class="cl">docker build -t todoing-frontend ./frontend
</span></span></code></pre></div><ol start="2">
<li>推送到 ECR：</li>
</ol>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">aws ecr get-login-password --region us-west-2 <span class="p">|</span> docker login --username AWS --password-stdin your-account.dkr.ecr.us-west-2.amazonaws.com
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">docker tag todoing-backend:latest your-account.dkr.ecr.us-west-2.amazonaws.com/todoing-backend:latest
</span></span><span class="line"><span class="cl">docker push your-account.dkr.ecr.us-west-2.amazonaws.com/todoing-backend:latest
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">docker tag todoing-frontend:latest your-account.dkr.ecr.us-west-2.amazonaws.com/todoing-frontend:latest
</span></span><span class="line"><span class="cl">docker push your-account.dkr.ecr.us-west-2.amazonaws.com/todoing-frontend:latest
</span></span></code></pre></div><h2 id="安全最佳实践">安全最佳实践</h2>
<h3 id="1-环境变量管理">1. 环境变量管理</h3>
<p>永远不要将敏感信息（如 API 密钥、密码）硬编码在代码中：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># 正确做法</span>
</span></span><span class="line"><span class="cl"><span class="nv">JWT_SECRET</span><span class="o">=</span><span class="si">${</span><span class="nv">JWT_SECRET</span><span class="si">}</span>
</span></span><span class="line"><span class="cl"><span class="nv">MONGO_URI</span><span class="o">=</span><span class="si">${</span><span class="nv">MONGO_URI</span><span class="si">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 错误做法</span>
</span></span><span class="line"><span class="cl"><span class="nv">JWT_SECRET</span><span class="o">=</span>my_secret_key_123
</span></span><span class="line"><span class="cl"><span class="nv">MONGO_URI</span><span class="o">=</span>mongodb://user:password@localhost:27017/todoing
</span></span></code></pre></div><h3 id="2-https-配置">2. HTTPS 配置</h3>
<p>在生产环境中，始终使用 HTTPS：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-nginx" data-lang="nginx"><span class="line"><span class="cl"><span class="c1"># nginx 配置示例
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">server</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kn">listen</span> <span class="mi">443</span> <span class="s">ssl</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">server_name</span> <span class="s">your-domain.com</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_certificate</span> <span class="s">/path/to/your/certificate.crt</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kn">ssl_certificate_key</span> <span class="s">/path/to/your/private.key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="kn">location</span> <span class="s">/</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_pass</span> <span class="s">http://localhost:3000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span> <span class="s">Host</span> <span class="nv">$host</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kn">proxy_set_header</span> <span class="s">X-Real-IP</span> <span class="nv">$remote_addr</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="3-数据库安全">3. 数据库安全</h3>
<ul>
<li>使用强密码</li>
<li>限制数据库访问权限</li>
<li>定期备份数据</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// MongoDB 安全配置示例
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">mongoose</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;mongoose&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">connectDB</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">conn</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">MONGO_URI</span><span class="p">,</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">useNewUrlParser</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">useUnifiedTopology</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 启用认证
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">auth</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">username</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">MONGO_USERNAME</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">password</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">MONGO_PASSWORD</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// SSL 配置（如果需要）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">ssl</span><span class="o">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">MONGO_SSL</span> <span class="o">===</span> <span class="s1">&#39;true&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="sb">`MongoDB 连接成功: </span><span class="si">${</span><span class="nx">conn</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">host</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="sb">`MongoDB 连接失败: </span><span class="si">${</span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">process</span><span class="p">.</span><span class="nx">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><h2 id="性能优化">性能优化</h2>
<h3 id="1-数据库索引优化">1. 数据库索引优化</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// 为常用查询字段创建索引
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">taskSchema</span><span class="p">.</span><span class="nx">index</span><span class="p">({</span> <span class="nx">createdBy</span><span class="o">:</span> <span class="mi">1</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">taskSchema</span><span class="p">.</span><span class="nx">index</span><span class="p">({</span> <span class="nx">status</span><span class="o">:</span> <span class="mi">1</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">taskSchema</span><span class="p">.</span><span class="nx">index</span><span class="p">({</span> <span class="nx">createdAt</span><span class="o">:</span> <span class="o">-</span><span class="mi">1</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="nx">taskSchema</span><span class="p">.</span><span class="nx">index</span><span class="p">({</span> <span class="s2">&#34;collaborators.user&#34;</span><span class="o">:</span> <span class="mi">1</span> <span class="p">});</span>
</span></span></code></pre></div><h3 id="2-缓存策略">2. 缓存策略</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// 使用 Redis 缓存用户数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">redis</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;redis&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="nx">redis</span><span class="p">.</span><span class="nx">createClient</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">getCachedUserData</span> <span class="o">=</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">userId</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">cached</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="sb">`user:</span><span class="si">${</span><span class="nx">userId</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">cached</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">cached</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl">  <span class="kr">const</span> <span class="nx">user</span> <span class="o">=</span> <span class="kr">await</span> <span class="nx">User</span><span class="p">.</span><span class="nx">findById</span><span class="p">(</span><span class="nx">userId</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="kr">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">setex</span><span class="p">(</span><span class="sb">`user:</span><span class="si">${</span><span class="nx">userId</span><span class="si">}</span><span class="sb">`</span><span class="p">,</span> <span class="mi">3600</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">user</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">user</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></div><h3 id="3-前端性能优化">3. 前端性能优化</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// 使用 React.memo 优化组件渲染
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">TaskItem</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">memo</span><span class="p">(({</span> <span class="nx">task</span><span class="p">,</span> <span class="nx">onEdit</span><span class="p">,</span> <span class="nx">onDelete</span> <span class="p">})</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;task-item&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">h3</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/h3&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="p">{</span><span class="nx">task</span><span class="p">.</span><span class="nx">description</span><span class="p">}</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">&#34;task-actions&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="p">=&gt;</span> <span class="nx">onEdit</span><span class="p">(</span><span class="nx">task</span><span class="p">)}</span><span class="o">&gt;</span><span class="nx">编辑</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="nx">button</span> <span class="nx">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="p">=&gt;</span> <span class="nx">onDelete</span><span class="p">(</span><span class="nx">task</span><span class="p">.</span><span class="nx">_id</span><span class="p">)}</span><span class="o">&gt;</span><span class="nx">删除</span><span class="o">&lt;</span><span class="err">/button&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/div&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><h2 id="监控和日志">监控和日志</h2>
<h3 id="1-应用日志">1. 应用日志</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// 后端日志配置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">winston</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;winston&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">expressWinston</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;express-winston&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">logger</span> <span class="o">=</span> <span class="nx">winston</span><span class="p">.</span><span class="nx">createLogger</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">level</span><span class="o">:</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nx">format</span><span class="o">:</span> <span class="nx">winston</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">combine</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">winston</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="nx">winston</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">transports</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="k">new</span> <span class="nx">winston</span><span class="p">.</span><span class="nx">transports</span><span class="p">.</span><span class="nx">File</span><span class="p">({</span> <span class="nx">filename</span><span class="o">:</span> <span class="s1">&#39;error.log&#39;</span><span class="p">,</span> <span class="nx">level</span><span class="o">:</span> <span class="s1">&#39;error&#39;</span> <span class="p">}),</span>
</span></span><span class="line"><span class="cl">    <span class="k">new</span> <span class="nx">winston</span><span class="p">.</span><span class="nx">transports</span><span class="p">.</span><span class="nx">File</span><span class="p">({</span> <span class="nx">filename</span><span class="o">:</span> <span class="s1">&#39;combined.log&#39;</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// HTTP 请求日志
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">expressWinston</span><span class="p">.</span><span class="nx">logger</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">transports</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="k">new</span> <span class="nx">winston</span><span class="p">.</span><span class="nx">transports</span><span class="p">.</span><span class="nx">File</span><span class="p">({</span> <span class="nx">filename</span><span class="o">:</span> <span class="s1">&#39;requests.log&#39;</span> <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="nx">format</span><span class="o">:</span> <span class="nx">winston</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">combine</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">winston</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">timestamp</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">    <span class="nx">winston</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">json</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">}));</span>
</span></span></code></pre></div><h3 id="2-健康检查端点">2. 健康检查端点</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">// 健康检查路由
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">router</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/health&#39;</span><span class="p">,</span> <span class="kr">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">try</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 检查数据库连接
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kr">await</span> <span class="nx">mongoose</span><span class="p">.</span><span class="nx">connection</span><span class="p">.</span><span class="nx">db</span><span class="p">.</span><span class="nx">admin</span><span class="p">().</span><span class="nx">ping</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1">// 检查其他依赖服务
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// ...
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    
</span></span><span class="line"><span class="cl">    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">200</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">status</span><span class="o">:</span> <span class="s1">&#39;healthy&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">timestamp</span><span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">toISOString</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">      <span class="nx">services</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">database</span><span class="o">:</span> <span class="s1">&#39;connected&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 其他服务状态
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">500</span><span class="p">).</span><span class="nx">json</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="nx">status</span><span class="o">:</span> <span class="s1">&#39;unhealthy&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">error</span><span class="o">:</span> <span class="nx">error</span><span class="p">.</span><span class="nx">message</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></div><h2 id="备份和恢复">备份和恢复</h2>
<h3 id="1-数据库备份">1. 数据库备份</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># MongoDB 备份脚本</span>
</span></span><span class="line"><span class="cl"><span class="c1">#!/bin/bash</span>
</span></span><span class="line"><span class="cl"><span class="nv">DATE</span><span class="o">=</span><span class="k">$(</span>date +%Y%m%d_%H%M%S<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">BACKUP_DIR</span><span class="o">=</span><span class="s2">&#34;/backups/mongodb&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">CONTAINER_NAME</span><span class="o">=</span><span class="s2">&#34;todoing_mongodb&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">mkdir -p <span class="nv">$BACKUP_DIR</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">docker <span class="nb">exec</span> <span class="nv">$CONTAINER_NAME</span> mongodump --out /dump
</span></span><span class="line"><span class="cl">docker cp <span class="nv">$CONTAINER_NAME</span>:/dump <span class="nv">$BACKUP_DIR</span>/<span class="nv">$DATE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 压缩备份</span>
</span></span><span class="line"><span class="cl">tar -czf <span class="nv">$BACKUP_DIR</span>/<span class="nv">$DATE</span>.tar.gz -C <span class="nv">$BACKUP_DIR</span> <span class="nv">$DATE</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 删除7天前的备份</span>
</span></span><span class="line"><span class="cl">find <span class="nv">$BACKUP_DIR</span> -name <span class="s2">&#34;*.tar.gz&#34;</span> -mtime +7 -delete
</span></span></code></pre></div><h3 id="2-自动化部署脚本">2. 自动化部署脚本</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span><span class="c1"># deploy.sh</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;开始部署 todoIng...&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 拉取最新代码</span>
</span></span><span class="line"><span class="cl">git pull origin main
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 构建 Docker 镜像</span>
</span></span><span class="line"><span class="cl">docker-compose build
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 停止并删除旧容器</span>
</span></span><span class="line"><span class="cl">docker-compose down
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 启动新容器</span>
</span></span><span class="line"><span class="cl">docker-compose up -d
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 等待服务启动</span>
</span></span><span class="line"><span class="cl">sleep <span class="m">30</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># 检查服务状态</span>
</span></span><span class="line"><span class="cl">docker-compose ps
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;部署完成！&#34;</span>
</span></span></code></pre></div><h2 id="总结">总结</h2>
<p>通过合理的部署方案和最佳实践，我们可以确保 todoIng 应用的稳定性、安全性和高性能。Docker Compose 提供了最简单快捷的部署方式，而手动部署和云平台部署则提供了更多的自定义选项。</p>
<p>关键要点包括：</p>
<ol>
<li><strong>选择合适的部署方式</strong>：根据实际需求选择 Docker Compose、手动部署或云平台部署</li>
<li><strong>安全管理</strong>：妥善管理环境变量和敏感信息</li>
<li><strong>性能优化</strong>：通过索引优化、缓存策略等手段提升性能</li>
<li><strong>监控和日志</strong>：建立完善的监控和日志系统</li>
<li><strong>备份和恢复</strong>：制定数据备份和恢复策略</li>
</ol>
<p>通过遵循这些最佳实践，您可以成功部署和维护一个稳定可靠的 todoIng 应用。希望这个系列文章能帮助您更好地理解和使用 todoIng，也期待您能基于这个项目构建出更加出色的任务管理系统。</p>

          </div>

          
          <div class="row">
            <div class="col-md-8">
            
              <div class="mb-5">
                
<div class="li-x div-x post-meta">
  <li class="pr-0"><a href="https://axfinn.github.io/tags/"><i class="fas fa-tags"></i></a></li>
  <div class="tags-sm">
    
      <li><a href="https://axfinn.github.io/tags/todoing" role="button">todoIng </a></li>
      
    
      <li><a href="https://axfinn.github.io/tags/%E9%83%A8%E7%BD%B2" role="button">部署 </a></li>
      
    
      <li><a href="https://axfinn.github.io/tags/docker" role="button">Docker </a></li>
      
    
      <li><a href="https://axfinn.github.io/tags/%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5" role="button">最佳实践 </a></li>
      
    
      <li><a href="https://axfinn.github.io/tags/devops" role="button">DevOps </a></li>
      
    
  </div>
</div>
              </div>
            
            </div>
            
          </div>
          

          
          <div class="row pt-3">
            <div class="col-md-6">
              
                <a href=https://axfinn.github.io/blog/2025-08/todoing-ai-report-generation/ class="post-meta">Previous
                  <div class="pt-2 pb-5 d-flex">
                    <i class="fas fa-angle-left text-grey font-weight-bold mr-2 active-color"></i>
                    <span>todoIng AI 报告生成：智能提升工作效率</span>
                  </div>
                </a>
              
            </div>
            
            <div class="col-md-6 text-right" >
              
            </div>
          </div>

          

        </div>
        

      </div>
      

      

    </div>
    


  </main>
  


    
    

<footer class="page-footer text-center font-small mt-4 wow fadeIn">


  
  <div class="pb-2 mt-5 pt-5">
    
      <a href="//github.com/axfinn " target="_blank" rel="noopener"><i class="fab fa-github mr-3" aria-hidden="true"></i></a>    
    
    

    

    

    

    

    


    
        <a href="mailto:521very@email.com"><i class="far fa-envelope-open mr-3" aria-hidden="true"></i></a>
    

    

    

  </div>
  

  
  <div class="copyright py-4">
    
    <span>  2016 - 2025 &copy; | Powered by Hugo and <a href='https://github.com/axfinn/AllinOne' target="_blank">AllinOne Theme</a>.  </span>
  </div>
  

  <div id="blog-pet">
    <div id="pet-toggle-button">X</div>
    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
        
        <circle cx="50" cy="60" r="35" fill="#FFDDC1"/>
        
        <path d="M30 30 Q35 10 45 30 Z" fill="#FFDDC1"/>
        
        <path d="M70 30 Q65 10 55 30 Z" fill="#FFDDC1"/>
        
        <circle cx="40" cy="50" r="5" fill="#333"/>
        <circle cx="60" cy="50" r="5" fill="#333"/>
        
        <path d="M45 70 Q50 75 55 70" stroke="#333" stroke-width="2" fill="none"/>
    </svg>
    <div id="pet-speech-bubble"></div>
</div>

</footer>


    






<script type="text/javascript" src="https://axfinn.github.io/js/vendors/jquery/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="https://axfinn.github.io/js/vendors/jquery/jquery.smooth-scroll.min.js"></script>



<script type="text/javascript" src="https://axfinn.github.io/js/vendors/popper.min.js"></script>
<script type="text/javascript" src="https://axfinn.github.io/js/vendors/holder.min.js"></script>
<script type="text/javascript" src="https://axfinn.github.io/js/vendors-extensions/bootstrap4/bootstrap.js" ></script>

<script type="text/javascript" src="https://axfinn.github.io/js/vendors/mdb/mdb.min.js"></script>

<script type="text/javascript" src="https://axfinn.github.io/js/main.js"></script>



  
  <script src="https://axfinn.github.io/js/vendors/highlight.pack.js"> </script>
  <script>hljs.initHighlightingOnLoad();</script>




 
  <script src="https://axfinn.github.io/js/vendors/katex/katex.min.js"> </script>
  <script src="https://axfinn.github.io/js/vendors/katex/contrib/auto-render.min.js"></script>

  <script>
      document.addEventListener("DOMContentLoaded", function () {
          renderMathInElement(document.body);
      });
  </script>








<script type="text/javascript">
  
  new WOW().init();
</script>

<script type="text/javascript" src="https://axfinn.github.io/js/pet.js"></script>




  </body>
</html>